# 結合テスト仕様書 (Integration Test Specification)

## 1. 目的
本ドキュメントは、単体テストを通過した各モジュールを結合し、システムとしての連動が正常に行われることを検証するためのテスト項目を定義する。

## 2. テスト対象範囲
- **UIとロジックの結合**: `ft.GestureDetector` (UI) から `State` (データ) への連携、および `ft.Canvas` への描画反映。
- **データ処理とAIモデルの結合**: `ImageProcessor` で生成された画像データが正しく `Predictor` に渡され、判定結果が返ってくるか。
- **判定結果とUIの結合**: `Predictor` の結果が正しくUI上のテキストとして表示されるか。

## 3. テスト実施環境
- OS: Linux (Dev Container) / Browser (Flet Web View)
- Python: 3.x
- 手動操作による検証が主となる (Fletアプリを起動して実施)

## 4. テスト項目

### 4.1 UI描画連携機能

| ID | テスト項目名 | 前提条件 | 入力操作 | 期待値 (Expected Result) | 備考 |
|----|------------|----------|---------|-------------------------|------|
| IT-01 | マウス/タッチ描画反映 | アプリ起動中 | キャンバス上でマウスをドラッグする | ドラッグした軌跡に沿って黒い線が遅延なく描画されること | |
| IT-02 | 複数ストローク描画 | 既に線が描画されている | 別の場所でドラッグして線を描く | 以前の線が消えずに、新しい線が追加されること | |
| IT-03 | クリア機能連携 | 線が描画されている | 「クリア」ボタンを押下 | キャンバス上のすべての線が消え、真っ白になること。内部データもリセットされていること | |

### 4.2 予測フロー連携

| ID | テスト項目名 | 前提条件 | 入力操作 | 期待値 (Expected Result) | 備考 |
|----|------------|----------|---------|-------------------------|------|
| IT-04 | 正常フロー (数字認識) | 数字 '3' を描画済み | 「判定」ボタンを押下 | 1. 画面に「処理中...」等の状態が表示される可能性がある<br>2. 1秒以内に結果「3」が表示されること | |
| IT-05 | 認識不能データ入力 | 全画面真っ黒に塗りつぶす等 | 「判定」ボタンを押下 | エラー落ちせず、何らかの認識結果（またはエラーメッセージ）が表示され、アプリが継続動作すること | |
| IT-06 | 未描画での判定 | キャンバスが白紙 | 「判定」ボタンを押下 | エラー落ちせず、「文字を書いてください」等のメッセージが出る、または特定の数字（予測不能）が表示されること | |

### 4.3 リソース管理

| ID | テスト項目名 | 前提条件 | 入力操作 | 期待値 (Expected Result) | 備考 |
|----|------------|----------|---------|-------------------------|------|
| IT-07 | 連続判定 | アプリ起動中 | 書く→判定→クリア→書く→判定 を10回繰り返す | メモリリークや動作遅延が発生せず、毎回正しく判定結果が出ること | |

## 5. 判定基準
すべてのテストケースにおいて、UI上の挙動および内部データの遷移が期待通りであること。エラーログが出力されていないこと。
